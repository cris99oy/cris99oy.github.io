<!DOCTYPE html>
<html>
<head>
  <title>Tabla sincronizada con Google Sheets</title>
  <style>
    table {
      border-collapse: collapse;
      width: 100%;
    }
    
    th, td {
      padding: 8px;
      text-align: left;
      border-bottom: 1px solid #ddd;
    }
    
    th {
      background-color: #f2f2f2;
    }
  </style>
  <link rel="stylesheet"
  href="style.css">
  <meta charset="utf-8">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6386264592853721"
          crossorigin="anonymous"></script>
                  <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-1SJWDVFRSC"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'G-1SJWDVFRSC');
        </script>
</head>
<body>
  <header class="header">
    <nav class="navigation">
      <a href="/">
        <img class="logo" src="/images/logo.gif">
      </a>
      <ul class="enlaces-menu">
              <li><a href="index.html">Inicio</a></li>
              <li><a href="TABLA.html">Ayuda</a></li>
              <li><a href="ayuda.html">Ayuda</a></li>
      </ul>
      <button class="ham" type="button">
        <span class="br-1"></span>
        <span class="br-2"></span>
        <span class="br-3"></span>
      </button>
    </nav>
  </header>
  <main class="main">
    <div class="container">
      <form method="get">
        <div class="form_searchbar">
          <input class="form_control" type="text" id="search-input" placeholder="Buscar...">
        </div>
      </form>
      <div class="cabesa">
        <table id="tabla-datos"></table>
      </div>
    </div>
  </main>
  <footer class="footer">
    <div class="container">
        <p>Copyright © 2023 derechos reservados</p>
    </div>
  </footer>

  <script>
    // ID de la hoja de Google Sheets
    var sheetId = '1gYYjtuq5ZOEt7lRwI7iXjnD7ZSiPbSsN0h-848-pZDI';

    // Rango de celdas que quieres obtener (por ejemplo, 'Sheet1!A1:D10')
    var range = 'modelos!B2:M200';

    // API de Google Sheets
    var apiKey = 'AIzaSyDO2uPnoBhPzXVzAFFTA2OJou5zyW35VV4';
    var url = 'https://sheets.googleapis.com/v4/spreadsheets/' + sheetId + '/values/' + range + '?key=' + apiKey;

    // Obtener los datos de Google Sheets
    fetch(url)
      .then(response => response.json())
      .then(data => {
        var table = document.getElementById('tabla-datos');
        var searchInput = document.getElementById('search-input');

        // Función para filtrar la tabla basado en la búsqueda
        function filtrarTabla() {
          var filtro = searchInput.value.toLowerCase();
          var rows = table.getElementsByTagName('tr');

          for (var i = 1; i < rows.length; i++) {
            var rowData = data.values[i];
            var row = rows[i];

            var encontrado = false;

            for (var j = 0; j < rowData.length; j++) {
              var cellData = rowData[j].toLowerCase();
              if (cellData.includes(filtro)) {
                encontrado = true;
                break;
              }
            }

            if (encontrado) {
              row.style.display = '';
            } else {
              row.style.display = 'none';
            }
          }
        }

        // Agregar evento de escucha al campo de búsqueda
        searchInput.addEventListener('input', filtrarTabla);

        // Crear la cabecera de la tabla
        var headerRow = document.createElement('tr');
        data.values[0].forEach(header => {
          var th = document.createElement('th');
          th.textContent = header;
          headerRow.appendChild(th);
        });
        table.appendChild(headerRow);

        // Crear las filas de datos
        for (var i = 1; i < data.values.length; i++) {
          var rowData = data.values[i];
          var row = document.createElement('tr');
          rowData.forEach(cellData => {
            var td = document.createElement('td');
            td.textContent = cellData;
            row.appendChild(td);
          });
          table.appendChild(row);
        }
      })
      .catch(error => {
        console.error('Error al obtener los datos:', error);
      });
  </script>
  <script src="Menu.js"></script>
</body>
</html>

